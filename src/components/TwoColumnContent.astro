---
// Custom TwoColumnContent component with TOC overlay toggle support
// Overrides @astrojs/starlight default TwoColumnContent component

// Type assertion for Starlight locals
const { starlightRoute } = Astro.locals as any;
---

<div class="lg:sl-flex">
	{
		starlightRoute.toc && (
			<aside class="right-sidebar-container print:hidden">
				<div class="right-sidebar">
					<slot name="right-sidebar" />
				</div>
			</aside>
		)
	}
	<div class="main-pane"><slot /></div>
</div>

<style>
	@layer starlight.core {
		.main-pane {
			isolation: isolate;
		}

		@media (min-width: 72rem) {
			/* TOC를 Overlay로 변경 - 항상 fixed position으로 우측에 배치 */
			.right-sidebar-container {
				position: fixed;
				right: 0;
				top: 0;
				bottom: 0;
				width: var(--sl-sidebar-width);
				z-index: 100;
				transition: transform 0.3s ease;
				background: var(--sl-color-bg);
				box-shadow: -2px 0 8px rgba(0, 0, 0, 0.1);
			}

			.right-sidebar {
				position: relative;
				border-inline-start: 1px solid var(--sl-color-hairline);
				padding-top: var(--sl-nav-height);
				width: 100%;
				height: 100vh;
				overflow-y: auto;
				scrollbar-width: none;
			}

			/* 메인 패널은 항상 전체 너비 사용 */
			.main-pane {
				width: 100%;
			}

			:global([data-has-sidebar][data-has-toc]) .main-pane {
				--sl-content-margin-inline: auto;
				width: 100%;
			}

			/* TOC 숨김 상태: 우측으로 슬라이드 아웃 */
			:global(body.toc-hidden) .right-sidebar-container {
				transform: translateX(100%);
			}

			/* TOC 표시 상태: 기본 위치 */
			:global(body:not(.toc-hidden)) .right-sidebar-container {
				transform: translateX(0);
			}
		}

		/* 태블릿 이하에서는 기존 동작 유지 */
		@media (max-width: 71.99rem) {
			.right-sidebar-container {
				display: none;
			}

			.main-pane {
				width: 100%;
			}
		}
	}
</style>
